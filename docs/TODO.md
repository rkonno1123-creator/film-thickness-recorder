# やることリスト

## 次やる（優先度高）

### UI改善
- [ ] **バー表示の仕様変更**
  - 現状：平均値でプロット
  - 変更：入力中の値でプロット（狙い値と同じ桁数になった時点で表示）
  - 層によって2桁 or 3桁（最小2桁、最大3桁）
- [ ] **追加測定時に前回データを表示**
  - 入力数値の近くに表示
  - データが多い場合はスクロール対応
  - ※将来的に「前回の膜厚」表示に統合するかも
- [ ] 複数測定器の登録後：「同じ箇所で別測定器」or「リストに戻る」を選択

### データ関連
- [ ] 層番号を選べるようにする（今は3層固定）
- [ ] 前回の膜厚を測定画面に表示する
- [ ] Firebase → Excel書き出し

---

## そのうちやる

- [ ] アプリから現場を追加できるようにする
- [ ] 測定データの上書き機能（再測定時に「追加」か「上書き」を選択）

---

## 完了（2025/01/08）

- [x] **追加測定ボタン追加**（CSV読込ボタンを置き換え）
- [x] **追加測定時は機種選択必須**（1台でもモーダル表示、全測定器から選択可）
- [x] **メモ欄を全測定画面に追加**（測定値リストの下、任意入力）
- [x] **登録後、リストの今の箇所周辺にスクロール維持**（ハイライト表示）
- [x] **スキップ・戻る・終了ボタン改善**（データ入力中は確認ダイアログ表示）
- [x] **個別選択モードのスキップで次の未測定箇所へ移動**
- [x] **戻るボタンでスクロール位置復元**
- [x] **スキップ後は画面トップにスクロール**（項目名が見えるように）
- [x] **SavedMeasurementにmemoフィールド追加**
- [x] **CSVエクスポートにmemo列追加**

## 完了（以前）

- [x] 測定器選択モーダル
- [x] 複数測定器対応
- [x] 測定器変更機能
- [x] 全画面表示
- [x] テンキーを上に移動
- [x] 現場選択機能
- [x] CSV空行対策
- [x] 測定器1台の場合はモーダルスキップ（通常モード）

---

## 設計メモ

### 測定器選択のルール
- セットアップで「今日使う測定器」を選ぶ（残す）
- 測定時：1機種 → 直接測定へ / 複数 → 選択モーダル

### 追加測定のユースケース
- キャリブレーションやり直し
- 測定し直したい箇所がある
- → メモ欄で理由を残せる

### Firebase構造（今後変えるかも）

今：
```
measurements/{auto-id}/...
```

将来：
```
sites/{siteId}/...
measurements/{siteId}/{id}/
  - layer: number  ← 層番号追加
  - memo: string   ← メモ追加
```
